<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <style>
      /* 確認用のCSS */
      body { background:#eef; }
      picture img, .apng-image { background: url(https://raw.githubusercontent.com/ics-creative/160609_animation-image-generator/master/app/imgs/opacity.png); }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apng-canvas/2.1.1/apng-canvas.min.js"></script>
    <title>APNG と GIF 比較</title>
  </head>
  <body>

    <h1>APNG と GIF 比較</h1>
    <p>APNGアニメとGIFアニメの表示確認をするためのページです。</p>
    <p>apng形式はブラウザによっては対応していないため、中央の画像は静止して見える可能性があります。（Chrome、Firefox、Safari以外は未対応か？）<br>
    左側の画像には「アニメ画像に変換する君」が出力したおまじない処理が入っているため、未対応ブラウザでもアニメ表示される可能性があります。<br>
    （参考１）<a href="http://blog.8bit.co.jp/?p=14780">GIFアニメは次世代へ！動くpng画像、apng形式の作り方</a><br>
    （参考２）<a href="https://ics.media/entry/12746/2">アニメ画像に変換する君</a></p>

    <!-- APNG と GIF 比較 -->
    <table>
      <tr><th>＜APNGアニメ(未対応処理あり)＞</th><th>＜APNGアニメ(素)＞</th><th>＜GIFアニメ＞</th></tr>

    <!-- 喜びの画像 -->
    <tr><td>

    <!-- Chrome と Firefox と Safari で再生可能 (IE, Edge ではアニメは再生できません) -->	
    <picture>
	  <!-- Chrome 用 -->
      <source type="image/webp" srcset="robo_body_grad.webp" />
      <!-- Firefox, Safari 用 -->
      <img src="robo_body_grad.png" width="263" height="272" alt="APNG画像" class="apng-image" />
    </picture>
  	
    <script>
      if(window.navigator.userAgent.indexOf('Chrome') >= 0 && window.navigator.userAgent.indexOf('Edge') == -1){
        // Chrome の場合は WebP ファイルが表示される
      }else{
        // Chrome 以外の場合は APNG 利用可否を判定する
        APNG.ifNeeded().then(function () {
          // APNG に未対応のブラウザ(例：IE, Edge)では、JSライブラリ「apng-canvas」により表示可能にする
          var images = document.querySelectorAll(".apng-image");
          for (var i = 0; i < images.length; i++){ APNG.animateImage(images[i]); }
        });
      }
    </script>

      </td><td><img src="robo_body_grad.png" width="263" height="272" alt="APNG画像" /></td>
      </td><td><img src="robo_body_grad.gif" width="263" height="272" alt="GIF画像" /></td></tr>

    <!-- 悲しみの画像 -->
    <tr><td>

    <!-- Chrome と Firefox と Safari で再生可能 (IE, Edge ではアニメは再生できません) -->	
    <picture>
	  <!-- Chrome 用 -->
      <source type="image/webp" srcset="robo_body_sad.webp" />
      <!-- Firefox, Safari 用 -->
      <img src="robo_body_sad.png" width="263" height="272" alt="APNG画像" class="apng-image2" />
    </picture>
  	
    <script>
      if(window.navigator.userAgent.indexOf('Chrome') >= 0 && window.navigator.userAgent.indexOf('Edge') == -1){
        // Chrome の場合は WebP ファイルが表示される
      }else{
        // Chrome 以外の場合は APNG 利用可否を判定する
        APNG.ifNeeded().then(function () {
          // APNG に未対応のブラウザ(例：IE, Edge)では、JSライブラリ「apng-canvas」により表示可能にする
          var images = document.querySelectorAll(".apng-image2");
          for (var i = 0; i < images.length; i++){ APNG.animateImage(images[i]); }
        });
      }
    </script>

      </td><td><img src="robo_body_sad.png" width="263" height="272" alt="APNG画像" /></td>
      </td><td><img src="robo_body_sad.gif" width="263" height="272" alt="GIF画像" /></td></tr>
      
    </table>
  </body>
</html>